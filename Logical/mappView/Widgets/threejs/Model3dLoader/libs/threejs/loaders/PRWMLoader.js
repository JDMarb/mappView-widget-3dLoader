/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","../_virtual/_rollupPluginBabelHelpers","../core/BufferAttribute","../core/BufferGeometry","./FileLoader","./Loader"],(function(r,e,t,n,a,i){"use strict";var o=null;function u(){if(null===o){var r=new ArrayBuffer(2),e=new Uint8Array(r),t=new Uint16Array(r);e[0]=170,e[1]=187,o=43707===t[0]}return o}var l=[null,Float32Array,null,Int8Array,Int16Array,null,Int32Array,Uint8Array,Uint16Array,null,Uint32Array],s={Uint16Array:"getUint16",Uint32Array:"getUint32",Int16Array:"getInt16",Int32Array:"getInt32",Float32Array:"getFloat32",Float64Array:"getFloat64"};function f(r,e,t,n,a){var i,o=e.BYTES_PER_ELEMENT;if(a===u()||1===o)i=new e(r,t,n);else{var l=new DataView(r,t,n*o),f=s[e.name],d=!a;i=new e(n);for(var c=0;c<n;c++)i[c]=l[f](c*o,d)}return i}var d=function(r){function i(e){return r.call(this,e)||this}e.inheritsLoose(i,r);var o=i.prototype;return o.load=function(r,e,t,n){var i=this,o=new a.FileLoader(i.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),r=r.replace(/\*/g,u()?"be":"le"),o.load(r,(function(t){try{e(i.parse(t))}catch(e){n?n(e):console.error(e),i.manager.itemError(r)}}),t,n)},o.parse=function(r){for(var e=function(r){var e=new Uint8Array(r),t=e[0],n=e[1],a=!!(n>>7&1),i=n>>6&1,o=1==(n>>5&1),u=31&n,s=0,d=0;if(o?(s=(e[2]<<16)+(e[3]<<8)+e[4],d=(e[5]<<16)+(e[6]<<8)+e[7]):(s=e[2]+(e[3]<<8)+(e[4]<<16),d=e[5]+(e[6]<<8)+(e[7]<<16)),0===t)throw new Error("PRWM decoder: Invalid format version: 0");if(1!==t)throw new Error("PRWM decoder: Unsupported format version: "+t);if(!a){if(0!==i)throw new Error("PRWM decoder: Indices type must be set to 0 for non-indexed geometries");if(0!==d)throw new Error("PRWM decoder: Number of indices must be set to 0 for non-indexed geometries")}for(var c=8,y={},v=0;v<u;v++){for(var A="";c<e.length;){var w=e[c];if(c++,0===w)break;A+=String.fromCharCode(w)}var h=(n=e[c])>>7&1,b=1+(n>>4&3),g=l[15&n];c++;var m=f(r,g,c=4*Math.ceil(c/4),b*s,o);c+=g.BYTES_PER_ELEMENT*b*s,y[A]={type:h,cardinality:b,values:m}}c=4*Math.ceil(c/4);var p=null;return a&&(p=f(r,1===i?Uint32Array:Uint16Array,c,d,o)),{version:t,attributes:y,indices:p}}(r),a=Object.keys(e.attributes),i=new n.BufferGeometry,o=0;o<a.length;o++){var u=e.attributes[a[o]];i.setAttribute(a[o],new t.BufferAttribute(u.values,u.cardinality,u.normalized))}return null!==e.indices&&i.setIndex(new t.BufferAttribute(e.indices,1)),i},i.isBigEndianPlatform=function(){return u()},i}(i.Loader);r.PRWMLoader=d,Object.defineProperty(r,"__esModule",{value:!0})}));
