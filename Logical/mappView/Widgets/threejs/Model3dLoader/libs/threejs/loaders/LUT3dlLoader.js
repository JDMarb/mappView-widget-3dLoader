/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","../_virtual/_rollupPluginBabelHelpers","./FileLoader","./Loader","../textures/DataTexture","../textures/Data3DTexture","../constants"],(function(e,r,t,a,i,n,p){"use strict";var o=function(e){function a(){return e.apply(this,arguments)||this}r.inheritsLoose(a,e);var o=a.prototype;return o.load=function(e,r,a,i){var n=this,p=new t.FileLoader(this.manager);p.setPath(this.path),p.setResponseType("text"),p.load(e,(function(t){try{r(n.parse(t))}catch(r){i?i(r):console.error(r),n.manager.itemError(e)}}),a,i)},o.parse=function(e){for(var r=(e=e.replace(/^#.*?(\n|\r)/gm,"").replace(/^\s*?(\n|\r)/gm,"").trim()).split(/[\n\r]+/g),t=r[0].trim().split(/\s+/g).map((function(e){return parseFloat(e)})),a=t[1]-t[0],o=t.length,l=1,s=t.length;l<s;l++)if(a!==t[l]-t[l-1])throw new Error("LUT3dlLoader: Inconsistent grid size not supported.");for(var g=new Array(o*o*o*4),m=0,d=0,h=1,u=r.length;h<u;h++){var c=r[h].trim().split(/\s/g),f=parseFloat(c[0]),F=parseFloat(c[1]),T=parseFloat(c[2]);d=Math.max(d,f,F,T);var w=m%o*o*o+Math.floor(m/o)%o*o+Math.floor(m/(o*o))%o;g[4*w+0]=f,g[4*w+1]=F,g[4*w+2]=T,g[4*w+3]=1,m+=1}for(var v=Math.ceil(Math.log2(d)),y=Math.pow(2,v),L=0,x=g.length;L<x;L+=4){var M=g[L+0],D=g[L+1],E=g[L+2];g[L+0]=255*M/y,g[L+1]=255*D/y,g[L+2]=255*E/y}var U=new Uint8Array(g),B=new i.DataTexture;B.image.data=U,B.image.width=o,B.image.height=o*o,B.format=p.RGBAFormat,B.type=p.UnsignedByteType,B.magFilter=p.LinearFilter,B.minFilter=p.LinearFilter,B.wrapS=p.ClampToEdgeWrapping,B.wrapT=p.ClampToEdgeWrapping,B.generateMipmaps=!1,B.needsUpdate=!0;var C=new n.Data3DTexture;return C.image.data=U,C.image.width=o,C.image.height=o,C.image.depth=o,C.format=p.RGBAFormat,C.type=p.UnsignedByteType,C.magFilter=p.LinearFilter,C.minFilter=p.LinearFilter,C.wrapS=p.ClampToEdgeWrapping,C.wrapT=p.ClampToEdgeWrapping,C.wrapR=p.ClampToEdgeWrapping,C.generateMipmaps=!1,C.needsUpdate=!0,{size:o,texture:B,texture3D:C}},a}(a.Loader);e.LUT3dlLoader=o,Object.defineProperty(e,"__esModule",{value:!0})}));
