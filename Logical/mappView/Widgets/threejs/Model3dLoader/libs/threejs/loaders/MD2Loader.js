/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","../_virtual/_rollupPluginBabelHelpers","../animation/AnimationClip","../core/BufferGeometry","./FileLoader","../core/BufferAttribute","./Loader","../math/Vector3"],(function(e,t,r,n,s,a,i,o){"use strict";var f=[[-.525731,0,.850651],[-.442863,.238856,.864188],[-.295242,0,.955423],[-.309017,.5,.809017],[-.16246,.262866,.951056],[0,0,1],[0,.850651,.525731],[-.147621,.716567,.681718],[.147621,.716567,.681718],[0,.525731,.850651],[.309017,.5,.809017],[.525731,0,.850651],[.295242,0,.955423],[.442863,.238856,.864188],[.16246,.262866,.951056],[-.681718,.147621,.716567],[-.809017,.309017,.5],[-.587785,.425325,.688191],[-.850651,.525731,0],[-.864188,.442863,.238856],[-.716567,.681718,.147621],[-.688191,.587785,.425325],[-.5,.809017,.309017],[-.238856,.864188,.442863],[-.425325,.688191,.587785],[-.716567,.681718,-.147621],[-.5,.809017,-.309017],[-.525731,.850651,0],[0,.850651,-.525731],[-.238856,.864188,-.442863],[0,.955423,-.295242],[-.262866,.951056,-.16246],[0,1,0],[0,.955423,.295242],[-.262866,.951056,.16246],[.238856,.864188,.442863],[.262866,.951056,.16246],[.5,.809017,.309017],[.238856,.864188,-.442863],[.262866,.951056,-.16246],[.5,.809017,-.309017],[.850651,.525731,0],[.716567,.681718,.147621],[.716567,.681718,-.147621],[.525731,.850651,0],[.425325,.688191,.587785],[.864188,.442863,.238856],[.688191,.587785,.425325],[.809017,.309017,.5],[.681718,.147621,.716567],[.587785,.425325,.688191],[.955423,.295242,0],[1,0,0],[.951056,.16246,.262866],[.850651,-.525731,0],[.955423,-.295242,0],[.864188,-.442863,.238856],[.951056,-.16246,.262866],[.809017,-.309017,.5],[.681718,-.147621,.716567],[.850651,0,.525731],[.864188,.442863,-.238856],[.809017,.309017,-.5],[.951056,.16246,-.262866],[.525731,0,-.850651],[.681718,.147621,-.716567],[.681718,-.147621,-.716567],[.850651,0,-.525731],[.809017,-.309017,-.5],[.864188,-.442863,-.238856],[.951056,-.16246,-.262866],[.147621,.716567,-.681718],[.309017,.5,-.809017],[.425325,.688191,-.587785],[.442863,.238856,-.864188],[.587785,.425325,-.688191],[.688191,.587785,-.425325],[-.147621,.716567,-.681718],[-.309017,.5,-.809017],[0,.525731,-.850651],[-.525731,0,-.850651],[-.442863,.238856,-.864188],[-.295242,0,-.955423],[-.16246,.262866,-.951056],[0,0,-1],[.295242,0,-.955423],[.16246,.262866,-.951056],[-.442863,-.238856,-.864188],[-.309017,-.5,-.809017],[-.16246,-.262866,-.951056],[0,-.850651,-.525731],[-.147621,-.716567,-.681718],[.147621,-.716567,-.681718],[0,-.525731,-.850651],[.309017,-.5,-.809017],[.442863,-.238856,-.864188],[.16246,-.262866,-.951056],[.238856,-.864188,-.442863],[.5,-.809017,-.309017],[.425325,-.688191,-.587785],[.716567,-.681718,-.147621],[.688191,-.587785,-.425325],[.587785,-.425325,-.688191],[0,-.955423,-.295242],[0,-1,0],[.262866,-.951056,-.16246],[0,-.850651,.525731],[0,-.955423,.295242],[.238856,-.864188,.442863],[.262866,-.951056,.16246],[.5,-.809017,.309017],[.716567,-.681718,.147621],[.525731,-.850651,0],[-.238856,-.864188,-.442863],[-.5,-.809017,-.309017],[-.262866,-.951056,-.16246],[-.850651,-.525731,0],[-.716567,-.681718,-.147621],[-.716567,-.681718,.147621],[-.525731,-.850651,0],[-.5,-.809017,.309017],[-.238856,-.864188,.442863],[-.262866,-.951056,.16246],[-.864188,-.442863,.238856],[-.809017,-.309017,.5],[-.688191,-.587785,.425325],[-.681718,-.147621,.716567],[-.442863,-.238856,.864188],[-.587785,-.425325,.688191],[-.309017,-.5,.809017],[-.147621,-.716567,.681718],[-.425325,-.688191,.587785],[-.16246,-.262866,.951056],[.442863,-.238856,.864188],[.16246,-.262866,.951056],[.309017,-.5,.809017],[.147621,-.716567,.681718],[0,-.525731,.850651],[.425325,-.688191,.587785],[.587785,-.425325,.688191],[.688191,-.587785,.425325],[-.955423,.295242,0],[-.951056,.16246,.262866],[-1,0,0],[-.850651,0,.525731],[-.955423,-.295242,0],[-.951056,-.16246,.262866],[-.864188,.442863,-.238856],[-.951056,.16246,-.262866],[-.809017,.309017,-.5],[-.864188,-.442863,-.238856],[-.951056,-.16246,-.262866],[-.809017,-.309017,-.5],[-.681718,.147621,-.716567],[-.681718,-.147621,-.716567],[-.850651,0,-.525731],[-.688191,.587785,-.425325],[-.587785,.425325,-.688191],[-.425325,.688191,-.587785],[-.425325,-.688191,-.587785],[-.587785,-.425325,-.688191],[-.688191,-.587785,-.425325]],u=function(e){function i(t){return e.call(this,t)||this}t.inheritsLoose(i,e);var u=i.prototype;return u.load=function(e,t,r,n){var a=this,i=new s.FileLoader(a.manager);i.setPath(a.path),i.setResponseType("arraybuffer"),i.setRequestHeader(a.requestHeader),i.setWithCredentials(a.withCredentials),i.load(e,(function(r){try{t(a.parse(r))}catch(t){n?n(t):console.error(t),a.manager.itemError(e)}}),r,n)},u.parse=function(e){for(var t=new DataView(e),s={},i=["ident","version","skinwidth","skinheight","framesize","num_skins","num_vertices","num_st","num_tris","num_glcmds","num_frames","offset_skins","offset_st","offset_tris","offset_frames","offset_glcmds","offset_end"],u=0;u<i.length;u++)s[i[u]]=t.getInt32(4*u,!0);if(844121161===s.ident&&8===s.version){if(s.offset_end===t.byteLength){for(var l=new n.BufferGeometry,m=[],h=s.offset_st,v=0,g=s.num_st;v<g;v++){var p=t.getInt16(h+0,!0),c=t.getInt16(h+2,!0);m.push(p/s.skinwidth,1-c/s.skinheight),h+=4}h=s.offset_tris;for(var d=[],_=[],b=0,w=s.num_tris;b<w;b++)d.push(t.getUint16(h+0,!0),t.getUint16(h+2,!0),t.getUint16(h+4,!0)),_.push(t.getUint16(h+6,!0),t.getUint16(h+8,!0),t.getUint16(h+10,!0)),h+=12;var F=new o.Vector3,A=new o.Vector3,y=[];h=s.offset_frames;for(var U=0,B=s.num_frames;U<B;U++){A.set(t.getFloat32(h+0,!0),t.getFloat32(h+4,!0),t.getFloat32(h+8,!0)),F.set(t.getFloat32(h+12,!0),t.getFloat32(h+16,!0),t.getFloat32(h+20,!0)),h+=24;for(var C=[],k=0;k<16;k++){var L=t.getUint8(h+k);if(0===L)break;C[k]=L}var M={name:String.fromCharCode.apply(null,C),vertices:[],normals:[]};h+=16;for(var D=0;D<s.num_vertices;D++){var V=t.getUint8(h++),q=t.getUint8(h++),x=t.getUint8(h++),z=f[t.getUint8(h++)];V=V*A.x+F.x,q=q*A.y+F.y,x=x*A.z+F.z,M.vertices.push(V,x,q),M.normals.push(z[0],z[2],z[1])}y.push(M)}for(var H=[],I=[],P=[],R=y[0].vertices,T=y[0].normals,G=0,S=d.length;G<S;G++){var j=3*d[G],E=R[j],N=R[j+1],O=R[j+2];H.push(E,N,O);var W=T[j],J=T[j+1],K=T[j+2];I.push(W,J,K);var Q=m[j=2*_[G]],X=m[j+1];P.push(Q,X)}l.setAttribute("position",new a.Float32BufferAttribute(H,3)),l.setAttribute("normal",new a.Float32BufferAttribute(I,3)),l.setAttribute("uv",new a.Float32BufferAttribute(P,2));for(var Y=[],Z=[],$=0,ee=y.length;$<ee;$++){var te=y[$],re=te.name;if(te.vertices.length>0){for(var ne=[],se=0,ae=d.length;se<ae;se++){var ie=3*d[se],oe=te.vertices[ie],fe=te.vertices[ie+1],ue=te.vertices[ie+2];ne.push(oe,fe,ue)}var le=new a.Float32BufferAttribute(ne,3);le.name=re,Y.push(le)}if(te.normals.length>0){for(var me=[],he=0,ve=d.length;he<ve;he++){var ge=3*d[he],pe=te.normals[ge],ce=te.normals[ge+1],de=te.normals[ge+2];me.push(pe,ce,de)}var _e=new a.Float32BufferAttribute(me,3);_e.name=re,Z.push(_e)}}return l.morphAttributes.position=Y,l.morphAttributes.normal=Z,l.morphTargetsRelative=!1,l.animations=r.AnimationClip.CreateClipsFromMorphTargetSequences(y,10),l}console.error("Corrupted MD2 file")}else console.error("Not a valid MD2 file")},i}(i.Loader);e.MD2Loader=u,Object.defineProperty(e,"__esModule",{value:!0})}));
