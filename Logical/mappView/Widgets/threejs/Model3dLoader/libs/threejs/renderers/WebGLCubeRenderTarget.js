/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","../_virtual/_rollupPluginBabelHelpers","../constants","../objects/Mesh","../geometries/BoxGeometry","../materials/ShaderMaterial","./shaders/UniformsUtils","./WebGLRenderTarget","../cameras/CubeCamera","../textures/CubeTexture"],(function(t,e,r,n,i,a,o,l,m,u){"use strict";var s=function(t){function l(e,n){var i;void 0===n&&(n={}),(i=t.call(this,e,e,n)||this).isWebGLCubeRenderTarget=!0;var a={width:e,height:e,depth:1},o=[a,a,a,a,a,a];return i.texture=new u.CubeTexture(o,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),i.texture.isRenderTargetTexture=!0,i.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,i.texture.minFilter=void 0!==n.minFilter?n.minFilter:r.LinearFilter,i}e.inheritsLoose(l,t);var s=l.prototype;return s.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;var l={tEquirect:{value:null}},u="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",s="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",c=new i.BoxGeometry(5,5,5),d=new a.ShaderMaterial({name:"CubemapFromEquirect",uniforms:o.cloneUniforms(l),vertexShader:u,fragmentShader:s,side:r.BackSide,blending:r.NoBlending});d.uniforms.tEquirect.value=e;var p=new n.Mesh(c,d),g=e.minFilter;return e.minFilter===r.LinearMipmapLinearFilter&&(e.minFilter=r.LinearFilter),new m.CubeCamera(1,10,this).update(t,p),e.minFilter=g,p.geometry.dispose(),p.material.dispose(),this},s.clear=function(t,e,r,n){for(var i=t.getRenderTarget(),a=0;a<6;a++)t.setRenderTarget(this,a),t.clear(e,r,n);t.setRenderTarget(i)},l}(l.WebGLRenderTarget);t.WebGLCubeRenderTarget=s,Object.defineProperty(t,"__esModule",{value:!0})}));
