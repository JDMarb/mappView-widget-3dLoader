/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","../_virtual/_rollupPluginBabelHelpers","../core/BufferGeometry","../core/BufferAttribute","../extras/curves/Curves","../math/Vector2","../math/Vector3","../extras/core/Shape","../extras/ShapeUtils"],(function(e,r,t,a,o,n,s,i,u){"use strict";var v=function(e){function t(t,o){var v;void 0===t&&(t=new i.Shape([new n.Vector2(.5,.5),new n.Vector2(-.5,.5),new n.Vector2(-.5,-.5),new n.Vector2(.5,-.5)])),void 0===o&&(o={}),(v=e.call(this)||this).type="ExtrudeGeometry",v.parameters={shapes:t,options:o},t=Array.isArray(t)?t:[t];for(var l=r.assertThisInitialized(v),c=[],f=[],p=0,d=t.length;p<d;p++){y(t[p])}function y(e){var r=[],t=void 0!==o.curveSegments?o.curveSegments:12,a=void 0!==o.steps?o.steps:1,i=void 0!==o.depth?o.depth:1,v=void 0===o.bevelEnabled||o.bevelEnabled,p=void 0!==o.bevelThickness?o.bevelThickness:.2,d=void 0!==o.bevelSize?o.bevelSize:p-.1,y=void 0!==o.bevelOffset?o.bevelOffset:0,g=void 0!==o.bevelSegments?o.bevelSegments:3,m=o.extrudePath,x=void 0!==o.UVGenerator?o.UVGenerator:h;void 0!==o.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),i=o.amount);var b,S,V,w,M,P=!1;m&&(b=m.getSpacedPoints(a),P=!0,v=!1,S=m.computeFrenetFrames(a,!1),V=new s.Vector3,w=new s.Vector3,M=new s.Vector3),v||(g=0,p=0,d=0,y=0);var E=e.extractPoints(t),N=E.shape,O=E.holes;if(!u.ShapeUtils.isClockWise(N)){N=N.reverse();for(var G=0,I=O.length;G<I;G++){var U=O[G];u.ShapeUtils.isClockWise(U)&&(O[G]=U.reverse())}}for(var A=u.ShapeUtils.triangulateShape(N,O),B=N,T=0,L=O.length;T<L;T++){var q=O[T];N=N.concat(q)}function z(e,r,t){return r||console.error("THREE.ExtrudeGeometry: vec does not exist"),r.clone().multiplyScalar(t).add(e)}var J=N.length,k=A.length;function F(e,r,t){var a,o,s,i=e.x-r.x,u=e.y-r.y,v=t.x-e.x,h=t.y-e.y,l=i*i+u*u,c=i*h-u*v;if(Math.abs(c)>Number.EPSILON){var f=Math.sqrt(l),p=Math.sqrt(v*v+h*h),d=r.x-u/f,y=r.y+i/f,g=((t.x-h/p-d)*h-(t.y+v/p-y)*v)/(i*h-u*v),m=(a=d+i*g-e.x)*a+(o=y+u*g-e.y)*o;if(m<=2)return new n.Vector2(a,o);s=Math.sqrt(m/2)}else{var x=!1;i>Number.EPSILON?v>Number.EPSILON&&(x=!0):i<-Number.EPSILON?v<-Number.EPSILON&&(x=!0):Math.sign(u)===Math.sign(h)&&(x=!0),x?(a=-u,o=i,s=Math.sqrt(l)):(a=i,o=u,s=Math.sqrt(l/2))}return new n.Vector2(a/s,o/s)}for(var W=[],_=0,C=B.length,H=C-1,j=_+1;_<C;_++,H++,j++)H===C&&(H=0),j===C&&(j=0),W[_]=F(B[_],B[H],B[j]);for(var R,D=[],K=W.concat(),Q=0,X=O.length;Q<X;Q++){var Y=O[Q];R=[];for(var Z=0,$=Y.length,ee=$-1,re=Z+1;Z<$;Z++,ee++,re++)ee===$&&(ee=0),re===$&&(re=0),R[Z]=F(Y[Z],Y[ee],Y[re]);D.push(R),K=K.concat(R)}for(var te=0;te<g;te++){for(var ae=te/g,oe=p*Math.cos(ae*Math.PI/2),ne=d*Math.sin(ae*Math.PI/2)+y,se=0,ie=B.length;se<ie;se++){var ue=z(B[se],W[se],ne);Le(ue.x,ue.y,-oe)}for(var ve=0,he=O.length;ve<he;ve++){var le=O[ve];R=D[ve];for(var ce=0,fe=le.length;ce<fe;ce++){var pe=z(le[ce],R[ce],ne);Le(pe.x,pe.y,-oe)}}}for(var de=d+y,ye=0;ye<J;ye++){var ge=v?z(N[ye],K[ye],de):N[ye];P?(w.copy(S.normals[0]).multiplyScalar(ge.x),V.copy(S.binormals[0]).multiplyScalar(ge.y),M.copy(b[0]).add(w).add(V),Le(M.x,M.y,M.z)):Le(ge.x,ge.y,0)}for(var me=1;me<=a;me++)for(var xe=0;xe<J;xe++){var be=v?z(N[xe],K[xe],de):N[xe];P?(w.copy(S.normals[me]).multiplyScalar(be.x),V.copy(S.binormals[me]).multiplyScalar(be.y),M.copy(b[me]).add(w).add(V),Le(M.x,M.y,M.z)):Le(be.x,be.y,i/a*me)}for(var Se=g-1;Se>=0;Se--){for(var Ve=Se/g,we=p*Math.cos(Ve*Math.PI/2),Me=d*Math.sin(Ve*Math.PI/2)+y,Pe=0,Ee=B.length;Pe<Ee;Pe++){var Ne=z(B[Pe],W[Pe],Me);Le(Ne.x,Ne.y,i+we)}for(var Oe=0,Ge=O.length;Oe<Ge;Oe++){var Ie=O[Oe];R=D[Oe];for(var Ue=0,Ae=Ie.length;Ue<Ae;Ue++){var Be=z(Ie[Ue],R[Ue],Me);P?Le(Be.x,Be.y+b[a-1].y,b[a-1].x+we):Le(Be.x,Be.y,i+we)}}}function Te(e,r){for(var t=e.length;--t>=0;){var o=t,n=t-1;n<0&&(n=e.length-1);for(var s=0,i=a+2*g;s<i;s++){var u=J*s,v=J*(s+1);ze(r+o+u,r+n+u,r+n+v,r+o+v)}}}function Le(e,t,a){r.push(e),r.push(t),r.push(a)}function qe(e,r,t){Je(e),Je(r),Je(t);var a=c.length/3,o=x.generateTopUV(l,c,a-3,a-2,a-1);ke(o[0]),ke(o[1]),ke(o[2])}function ze(e,r,t,a){Je(e),Je(r),Je(a),Je(r),Je(t),Je(a);var o=c.length/3,n=x.generateSideWallUV(l,c,o-6,o-3,o-2,o-1);ke(n[0]),ke(n[1]),ke(n[3]),ke(n[1]),ke(n[2]),ke(n[3])}function Je(e){c.push(r[3*e+0]),c.push(r[3*e+1]),c.push(r[3*e+2])}function ke(e){f.push(e.x),f.push(e.y)}!function(){var e=c.length/3;if(v){for(var r=0,t=J*r,o=0;o<k;o++){var n=A[o];qe(n[2]+t,n[1]+t,n[0]+t)}t=J*(r=a+2*g);for(var s=0;s<k;s++){var i=A[s];qe(i[0]+t,i[1]+t,i[2]+t)}}else{for(var u=0;u<k;u++){var h=A[u];qe(h[2],h[1],h[0])}for(var f=0;f<k;f++){var p=A[f];qe(p[0]+J*a,p[1]+J*a,p[2]+J*a)}}l.addGroup(e,c.length/3-e,0)}(),function(){var e=c.length/3,r=0;Te(B,r),r+=B.length;for(var t=0,a=O.length;t<a;t++){var o=O[t];Te(o,r),r+=o.length}l.addGroup(e,c.length/3-e,1)}()}return v.setAttribute("position",new a.Float32BufferAttribute(c,3)),v.setAttribute("uv",new a.Float32BufferAttribute(f,2)),v.computeVertexNormals(),v}return r.inheritsLoose(t,e),t.prototype.toJSON=function(){var r=e.prototype.toJSON.call(this);return function(e,r,t){if(t.shapes=[],Array.isArray(e))for(var a=0,o=e.length;a<o;a++){var n=e[a];t.shapes.push(n.uuid)}else t.shapes.push(e.uuid);t.options=Object.assign({},r),void 0!==r.extrudePath&&(t.options.extrudePath=r.extrudePath.toJSON());return t}(this.parameters.shapes,this.parameters.options,r)},t.fromJSON=function(e,r){for(var a=[],n=0,s=e.shapes.length;n<s;n++){var i=r[e.shapes[n]];a.push(i)}var u=e.options.extrudePath;return void 0!==u&&(e.options.extrudePath=(new o[u.type]).fromJSON(u)),new t(a,e.options)},t}(t.BufferGeometry),h={generateTopUV:function(e,r,t,a,o){var s=r[3*t],i=r[3*t+1],u=r[3*a],v=r[3*a+1],h=r[3*o],l=r[3*o+1];return[new n.Vector2(s,i),new n.Vector2(u,v),new n.Vector2(h,l)]},generateSideWallUV:function(e,r,t,a,o,s){var i=r[3*t],u=r[3*t+1],v=r[3*t+2],h=r[3*a],l=r[3*a+1],c=r[3*a+2],f=r[3*o],p=r[3*o+1],d=r[3*o+2],y=r[3*s],g=r[3*s+1],m=r[3*s+2];return Math.abs(u-l)<Math.abs(i-h)?[new n.Vector2(i,1-v),new n.Vector2(h,1-c),new n.Vector2(f,1-d),new n.Vector2(y,1-m)]:[new n.Vector2(u,1-v),new n.Vector2(l,1-c),new n.Vector2(p,1-d),new n.Vector2(g,1-m)]}};e.ExtrudeBufferGeometry=v,e.ExtrudeGeometry=v,Object.defineProperty(e,"__esModule",{value:!0})}));
