/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","./PropertyBinding","../math/MathUtils"],(function(t,i,e){"use strict";var s=function(){function t(){this.isAnimationObjectGroup=!0,this.uuid=e.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var i=0,s=arguments.length;i!==s;++i)t[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}var s=t.prototype;return s.add=function(){for(var t=this._objects,e=this._indicesByUUID,s=this._paths,n=this._parsedPaths,r=this._bindings,h=r.length,a=void 0,o=t.length,d=this.nCachedObjects_,c=0,u=arguments.length;c!==u;++c){var _=arguments[c],p=_.uuid,v=e[p];if(void 0===v){v=o++,e[p]=v,t.push(_);for(var b=0,g=h;b!==g;++b)r[b].push(new i.PropertyBinding(_,s[b],n[b]))}else if(v<d){a=t[v];var f=--d,l=t[f];e[l.uuid]=v,t[v]=l,e[p]=f,t[f]=_;for(var j=0,y=h;j!==y;++j){var O=r[j],U=O[f],P=O[v];O[v]=U,void 0===P&&(P=new i.PropertyBinding(_,s[j],n[j])),O[f]=P}}else t[v]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=d},s.remove=function(){for(var t=this._objects,i=this._indicesByUUID,e=this._bindings,s=e.length,n=this.nCachedObjects_,r=0,h=arguments.length;r!==h;++r){var a=arguments[r],o=a.uuid,d=i[o];if(void 0!==d&&d>=n){var c=n++,u=t[c];i[u.uuid]=d,t[d]=u,i[o]=c,t[c]=a;for(var _=0,p=s;_!==p;++_){var v=e[_],b=v[c],g=v[d];v[d]=b,v[c]=g}}}this.nCachedObjects_=n},s.uncache=function(){for(var t=this._objects,i=this._indicesByUUID,e=this._bindings,s=e.length,n=this.nCachedObjects_,r=t.length,h=0,a=arguments.length;h!==a;++h){var o=arguments[h],d=o.uuid,c=i[d];if(void 0!==c)if(delete i[d],c<n){var u=--n,_=t[u],p=--r,v=t[p];i[_.uuid]=c,t[c]=_,i[v.uuid]=u,t[u]=v,t.pop();for(var b=0,g=s;b!==g;++b){var f=e[b],l=f[u],j=f[p];f[c]=l,f[u]=j,f.pop()}}else{var y=--r,O=t[y];y>0&&(i[O.uuid]=c),t[c]=O,t.pop();for(var U=0,P=s;U!==P;++U){var B=e[U];B[c]=B[y],B.pop()}}}this.nCachedObjects_=n},s.subscribe_=function(t,e){var s=this._bindingsIndicesByPath,n=s[t],r=this._bindings;if(void 0!==n)return r[n];var h=this._paths,a=this._parsedPaths,o=this._objects,d=o.length,c=this.nCachedObjects_,u=new Array(d);n=r.length,s[t]=n,h.push(t),a.push(e),r.push(u);for(var _=c,p=o.length;_!==p;++_){var v=o[_];u[_]=new i.PropertyBinding(v,t,e)}return u},s.unsubscribe_=function(t){var i=this._bindingsIndicesByPath,e=i[t];if(void 0!==e){var s=this._paths,n=this._parsedPaths,r=this._bindings,h=r.length-1,a=r[h];i[t[h]]=e,r[e]=a,r.pop(),n[e]=n[h],n.pop(),s[e]=s[h],s.pop()}},t}();t.AnimationObjectGroup=s,Object.defineProperty(t,"__esModule",{value:!0})}));
