/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","../constants","../math/interpolants/CubicInterpolant","../math/interpolants/LinearInterpolant","../math/interpolants/DiscreteInterpolant","./AnimationUtils"],(function(t,e,r,i,a,n){"use strict";var o=function(){function t(t,e,r,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=n.AnimationUtils.convertArray(e,this.TimeBufferType),this.values=n.AnimationUtils.convertArray(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}t.toJSON=function(t){var e,r=t.constructor;if(r.toJSON!==this.toJSON)e=r.toJSON(t);else{e={name:t.name,times:n.AnimationUtils.convertArray(t.times,Array),values:n.AnimationUtils.convertArray(t.values,Array)};var i=t.getInterpolation();i!==t.DefaultInterpolation&&(e.interpolation=i)}return e.type=t.ValueTypeName,e};var o=t.prototype;return o.InterpolantFactoryMethodDiscrete=function(t){return new a.DiscreteInterpolant(this.times,this.values,this.getValueSize(),t)},o.InterpolantFactoryMethodLinear=function(t){return new i.LinearInterpolant(this.times,this.values,this.getValueSize(),t)},o.InterpolantFactoryMethodSmooth=function(t){return new r.CubicInterpolant(this.times,this.values,this.getValueSize(),t)},o.setInterpolation=function(t){var r;switch(t){case e.InterpolateDiscrete:r=this.InterpolantFactoryMethodDiscrete;break;case e.InterpolateLinear:r=this.InterpolantFactoryMethodLinear;break;case e.InterpolateSmooth:r=this.InterpolantFactoryMethodSmooth}if(void 0===r){var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=r,this},o.getInterpolation=function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return e.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return e.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return e.InterpolateSmooth}},o.getValueSize=function(){return this.values.length/this.times.length},o.shift=function(t){if(0!==t)for(var e=this.times,r=0,i=e.length;r!==i;++r)e[r]+=t;return this},o.scale=function(t){if(1!==t)for(var e=this.times,r=0,i=e.length;r!==i;++r)e[r]*=t;return this},o.trim=function(t,e){for(var r=this.times,i=r.length,a=0,o=i-1;a!==i&&r[a]<t;)++a;for(;-1!==o&&r[o]>e;)--o;if(++o,0!==a||o!==i){a>=o&&(a=(o=Math.max(o,1))-1);var s=this.getValueSize();this.times=n.AnimationUtils.arraySlice(r,a,o),this.values=n.AnimationUtils.arraySlice(this.values,a*s,o*s)}return this},o.validate=function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var r=this.times,i=this.values,a=r.length;0===a&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var o=null,s=0;s!==a;s++){var l=r[s];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,l),t=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,l,o),t=!1;break}o=l}if(void 0!==i&&n.AnimationUtils.isTypedArray(i))for(var h=0,c=i.length;h!==c;++h){var u=i[h];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,h,u),t=!1;break}}return t},o.optimize=function(){for(var t=n.AnimationUtils.arraySlice(this.times),r=n.AnimationUtils.arraySlice(this.values),i=this.getValueSize(),a=this.getInterpolation()===e.InterpolateSmooth,o=t.length-1,s=1,l=1;l<o;++l){var h=!1,c=t[l];if(c!==t[l+1]&&(1!==l||c!==t[0]))if(a)h=!0;else for(var u=l*i,f=u-i,m=u+i,p=0;p!==i;++p){var y=r[u+p];if(y!==r[f+p]||y!==r[m+p]){h=!0;break}}if(h){if(l!==s){t[s]=t[l];for(var v=l*i,I=s*i,d=0;d!==i;++d)r[I+d]=r[v+d]}++s}}if(o>0){t[s]=t[o];for(var T=o*i,S=s*i,k=0;k!==i;++k)r[S+k]=r[T+k];++s}return s!==t.length?(this.times=n.AnimationUtils.arraySlice(t,0,s),this.values=n.AnimationUtils.arraySlice(r,0,s*i)):(this.times=t,this.values=r),this},o.clone=function(){var t=n.AnimationUtils.arraySlice(this.times,0),e=n.AnimationUtils.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,t,e);return r.createInterpolant=this.createInterpolant,r},t}();o.prototype.TimeBufferType=Float32Array,o.prototype.ValueBufferType=Float32Array,o.prototype.DefaultInterpolation=e.InterpolateLinear,t.KeyframeTrack=o,Object.defineProperty(t,"__esModule",{value:!0})}));
