/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","../../_virtual/_rollupPluginBabelHelpers","../../math/Vector3","../core/Curve"],(function(t,o,e,i){"use strict";function n(){var t=0,o=0,e=0,i=0;function n(n,r,s,l){t=n,o=s,e=-3*n+3*r-2*s-l,i=2*n-2*r+s+l}return{initCatmullRom:function(t,o,e,i,r){n(o,e,r*(e-t),r*(i-o))},initNonuniformCatmullRom:function(t,o,e,i,r,s,l){var c=(o-t)/r-(e-t)/(r+s)+(e-o)/s,u=(e-o)/s-(i-o)/(s+l)+(i-e)/l;n(o,e,c*=s,u*=s)},calc:function(n){var r=n*n;return t+o*n+e*r+i*(r*n)}}}var r=new e.Vector3,s=new n,l=new n,c=new n,u=function(t){function i(o,e,i,n){var r;return void 0===o&&(o=[]),void 0===e&&(e=!1),void 0===i&&(i="centripetal"),void 0===n&&(n=.5),(r=t.call(this)||this).isCatmullRomCurve3=!0,r.type="CatmullRomCurve3",r.points=o,r.closed=e,r.curveType=i,r.tension=n,r}o.inheritsLoose(i,t);var n=i.prototype;return n.getPoint=function(t,o){void 0===o&&(o=new e.Vector3);var i,n,u=o,a=this.points,h=a.length,p=(h-(this.closed?0:1))*t,v=Math.floor(p),m=p-v;this.closed?v+=v>0?0:(Math.floor(Math.abs(v)/h)+1)*h:0===m&&v===h-1&&(v=h-2,m=1),this.closed||v>0?i=a[(v-1)%h]:(r.subVectors(a[0],a[1]).add(a[0]),i=r);var d=a[v%h],y=a[(v+1)%h];if(this.closed||v+2<h?n=a[(v+2)%h]:(r.subVectors(a[h-1],a[h-2]).add(a[h-1]),n=r),"centripetal"===this.curveType||"chordal"===this.curveType){var f="chordal"===this.curveType?.5:.25,C=Math.pow(i.distanceToSquared(d),f),T=Math.pow(d.distanceToSquared(y),f),R=Math.pow(y.distanceToSquared(n),f);T<1e-4&&(T=1),C<1e-4&&(C=T),R<1e-4&&(R=T),s.initNonuniformCatmullRom(i.x,d.x,y.x,n.x,C,T,R),l.initNonuniformCatmullRom(i.y,d.y,y.y,n.y,C,T,R),c.initNonuniformCatmullRom(i.z,d.z,y.z,n.z,C,T,R)}else"catmullrom"===this.curveType&&(s.initCatmullRom(i.x,d.x,y.x,n.x,this.tension),l.initCatmullRom(i.y,d.y,y.y,n.y,this.tension),c.initCatmullRom(i.z,d.z,y.z,n.z,this.tension));return u.set(s.calc(m),l.calc(m),c.calc(m)),u},n.copy=function(o){t.prototype.copy.call(this,o),this.points=[];for(var e=0,i=o.points.length;e<i;e++){var n=o.points[e];this.points.push(n.clone())}return this.closed=o.closed,this.curveType=o.curveType,this.tension=o.tension,this},n.toJSON=function(){var o=t.prototype.toJSON.call(this);o.points=[];for(var e=0,i=this.points.length;e<i;e++){var n=this.points[e];o.points.push(n.toArray())}return o.closed=this.closed,o.curveType=this.curveType,o.tension=this.tension,o},n.fromJSON=function(o){t.prototype.fromJSON.call(this,o),this.points=[];for(var i=0,n=o.points.length;i<n;i++){var r=o.points[i];this.points.push((new e.Vector3).fromArray(r))}return this.closed=o.closed,this.curveType=o.curveType,this.tension=o.tension,this},i}(i.Curve);t.CatmullRomCurve3=u,Object.defineProperty(t,"__esModule",{value:!0})}));
