/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","../_virtual/_rollupPluginBabelHelpers","../math/Vector2","../math/Vector3","../math/Matrix4","../math/Triangle","../core/Object3D","../core/BufferGeometry","../core/InterleavedBuffer","../core/InterleavedBufferAttribute","../materials/SpriteMaterial"],(function(e,t,r,a,i,n,o,c,s,l,u){"use strict";var p,m=new a.Vector3,y=new a.Vector3,f=new a.Vector3,d=new r.Vector2,v=new r.Vector2,h=new i.Matrix4,w=new a.Vector3,V=new a.Vector3,x=new a.Vector3,M=new r.Vector2,b=new r.Vector2,g=new r.Vector2,S=function(e){function a(t){var a;if((a=e.call(this)||this).isSprite=!0,a.type="Sprite",void 0===p){p=new c.BufferGeometry;var i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new s.InterleavedBuffer(i,5);p.setIndex([0,1,2,0,2,3]),p.setAttribute("position",new l.InterleavedBufferAttribute(n,3,0,!1)),p.setAttribute("uv",new l.InterleavedBufferAttribute(n,2,3,!1))}return a.geometry=p,a.material=void 0!==t?t:new u.SpriteMaterial,a.center=new r.Vector2(.5,.5),a}t.inheritsLoose(a,e);var i=a.prototype;return i.raycast=function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),y.setFromMatrixScale(this.matrixWorld),h.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),f.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&y.multiplyScalar(-f.z);var a,i,o=this.material.rotation;0!==o&&(i=Math.cos(o),a=Math.sin(o));var c=this.center;B(w.set(-.5,-.5,0),f,c,y,a,i),B(V.set(.5,-.5,0),f,c,y,a,i),B(x.set(.5,.5,0),f,c,y,a,i),M.set(0,0),b.set(1,0),g.set(1,1);var s=e.ray.intersectTriangle(w,V,x,!1,m);if(null!==s||(B(V.set(-.5,.5,0),f,c,y,a,i),b.set(0,1),null!==(s=e.ray.intersectTriangle(w,x,V,!1,m)))){var l=e.ray.origin.distanceTo(m);l<e.near||l>e.far||t.push({distance:l,point:m.clone(),uv:n.Triangle.getUV(m,w,V,x,M,b,g,new r.Vector2),face:null,object:this})}},i.copy=function(t,r){return e.prototype.copy.call(this,t,r),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this},a}(o.Object3D);function B(e,t,r,a,i,n){d.subVectors(e,r).addScalar(.5).multiply(a),void 0!==i?(v.x=n*d.x-i*d.y,v.y=i*d.x+n*d.y):v.copy(d),e.copy(t),e.x+=v.x,e.y+=v.y,e.applyMatrix4(h)}e.Sprite=S,Object.defineProperty(e,"__esModule",{value:!0})}));
