/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","../_virtual/_rollupPluginBabelHelpers","../math/Sphere","../math/Ray","../math/Matrix4","../core/Object3D","../math/Vector3","../materials/PointsMaterial","../core/BufferGeometry"],(function(t,e,r,a,i,o,n,s,h){"use strict";var c=new i.Matrix4,u=new a.Ray,p=new r.Sphere,l=new n.Vector3,f=function(t){function r(e,r){var a;return void 0===e&&(e=new h.BufferGeometry),void 0===r&&(r=new s.PointsMaterial),(a=t.call(this)||this).isPoints=!0,a.type="Points",a.geometry=e,a.material=r,a.updateMorphTargets(),a}e.inheritsLoose(r,t);var a=r.prototype;return a.copy=function(e,r){return t.prototype.copy.call(this,e,r),this.material=e.material,this.geometry=e.geometry,this},a.raycast=function(t,e){var r=this.geometry,a=this.matrixWorld,i=t.params.Points.threshold,o=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),p.copy(r.boundingSphere),p.applyMatrix4(a),p.radius+=i,!1!==t.ray.intersectsSphere(p)){c.copy(a).invert(),u.copy(t.ray).applyMatrix4(c);var n=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=n*n,h=r.index,f=r.attributes.position;if(null!==h)for(var y=Math.max(0,o.start),d=Math.min(h.count,o.start+o.count);y<d;y++){var g=h.getX(y);l.fromBufferAttribute(f,g),m(l,g,s,a,t,e,this)}else for(var v=Math.max(0,o.start),M=Math.min(f.count,o.start+o.count);v<M;v++)l.fromBufferAttribute(f,v),m(l,v,s,a,t,e,this)}},a.updateMorphTargets=function(){var t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){var r=t[e[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var a=0,i=r.length;a<i;a++){var o=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}},r}(o.Object3D);function m(t,e,r,a,i,o,s){var h=u.distanceSqToPoint(t);if(h<r){var c=new n.Vector3;u.closestPointToPoint(t,c),c.applyMatrix4(a);var p=i.ray.origin.distanceTo(c);if(p<i.near||p>i.far)return;o.push({distance:p,distanceToRay:Math.sqrt(h),point:c,index:e,face:null,object:s})}}t.Points=f,Object.defineProperty(t,"__esModule",{value:!0})}));
