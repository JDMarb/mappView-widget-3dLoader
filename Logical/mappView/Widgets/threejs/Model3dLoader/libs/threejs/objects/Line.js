/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","../_virtual/_rollupPluginBabelHelpers","../math/Sphere","../math/Ray","../math/Matrix4","../core/Object3D","../math/Vector3","../materials/LineBasicMaterial","../core/BufferGeometry","../core/BufferAttribute"],(function(t,e,r,i,a,n,o,s,c,u){"use strict";var l=new o.Vector3,f=new o.Vector3,h=new a.Matrix4,p=new i.Ray,m=new r.Sphere,y=function(t){function r(e,r){var i;return void 0===e&&(e=new c.BufferGeometry),void 0===r&&(r=new s.LineBasicMaterial),(i=t.call(this)||this).isLine=!0,i.type="Line",i.geometry=e,i.material=r,i.updateMorphTargets(),i}e.inheritsLoose(r,t);var i=r.prototype;return i.copy=function(e,r){return t.prototype.copy.call(this,e,r),this.material=e.material,this.geometry=e.geometry,this},i.computeLineDistances=function(){var t=this.geometry;if(null===t.index){for(var e=t.attributes.position,r=[0],i=1,a=e.count;i<a;i++)l.fromBufferAttribute(e,i-1),f.fromBufferAttribute(e,i),r[i]=r[i-1],r[i]+=l.distanceTo(f);t.setAttribute("lineDistance",new u.Float32BufferAttribute(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this},i.raycast=function(t,e){var r=this.geometry,i=this.matrixWorld,a=t.params.Line.threshold,n=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),m.copy(r.boundingSphere),m.applyMatrix4(i),m.radius+=a,!1!==t.ray.intersectsSphere(m)){h.copy(i).invert(),p.copy(t.ray).applyMatrix4(h);var s=a/((this.scale.x+this.scale.y+this.scale.z)/3),c=s*s,u=new o.Vector3,l=new o.Vector3,f=new o.Vector3,y=new o.Vector3,d=this.isLineSegments?2:1,g=r.index,x=r.attributes.position;if(null!==g)for(var b=Math.max(0,n.start),v=Math.min(g.count,n.start+n.count)-1;b<v;b+=d){var M=g.getX(b),w=g.getX(b+1);if(u.fromBufferAttribute(x,M),l.fromBufferAttribute(x,w),!(p.distanceSqToSegment(u,l,y,f)>c)){y.applyMatrix4(this.matrixWorld);var B=t.ray.origin.distanceTo(y);B<t.near||B>t.far||e.push({distance:B,point:f.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else for(var S=Math.max(0,n.start),T=Math.min(x.count,n.start+n.count)-1;S<T;S+=d){if(u.fromBufferAttribute(x,S),l.fromBufferAttribute(x,S+1),!(p.distanceSqToSegment(u,l,y,f)>c)){y.applyMatrix4(this.matrixWorld);var L=t.ray.origin.distanceTo(y);L<t.near||L>t.far||e.push({distance:L,point:f.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}}},i.updateMorphTargets=function(){var t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){var r=t[e[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var n=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=i}}}},r}(n.Object3D);t.Line=y,Object.defineProperty(t,"__esModule",{value:!0})}));
