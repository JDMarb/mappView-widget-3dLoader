/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
define(["exports","../_virtual/_rollupPluginBabelHelpers","../core/EventDispatcher","../constants","../math/MathUtils","../math/Vector2","../math/Matrix3","./Source"],(function(t,e,i,r,a,s,n,p){"use strict";var o=0,h=function(t){function i(h,u,l,c,m,d,f,y,g,x){var M;return void 0===h&&(h=i.DEFAULT_IMAGE),void 0===u&&(u=i.DEFAULT_MAPPING),void 0===l&&(l=r.ClampToEdgeWrapping),void 0===c&&(c=r.ClampToEdgeWrapping),void 0===m&&(m=r.LinearFilter),void 0===d&&(d=r.LinearMipmapLinearFilter),void 0===f&&(f=r.RGBAFormat),void 0===y&&(y=r.UnsignedByteType),void 0===g&&(g=1),void 0===x&&(x=r.LinearEncoding),(M=t.call(this)||this).isTexture=!0,Object.defineProperty(e.assertThisInitialized(M),"id",{value:o++}),M.uuid=a.generateUUID(),M.name="",M.source=new p.Source(h),M.mipmaps=[],M.mapping=u,M.wrapS=l,M.wrapT=c,M.magFilter=m,M.minFilter=d,M.anisotropy=g,M.format=f,M.internalFormat=null,M.type=y,M.offset=new s.Vector2(0,0),M.repeat=new s.Vector2(1,1),M.center=new s.Vector2(0,0),M.rotation=0,M.matrixAutoUpdate=!0,M.matrix=new n.Matrix3,M.generateMipmaps=!0,M.premultiplyAlpha=!1,M.flipY=!0,M.unpackAlignment=4,M.encoding=x,M.userData={},M.version=0,M.onUpdate=null,M.isRenderTargetTexture=!1,M.needsPMREMUpdate=!1,M}e.inheritsLoose(i,t);var h=i.prototype;return h.updateMatrix=function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},h.clone=function(){return(new this.constructor).copy(this)},h.copy=function(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this},h.toJSON=function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),e||(t.textures[this.uuid]=i),i},h.dispose=function(){this.dispatchEvent({type:"dispose"})},h.transformUv=function(t){if(this.mapping!==r.UVMapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case r.RepeatWrapping:t.x=t.x-Math.floor(t.x);break;case r.ClampToEdgeWrapping:t.x=t.x<0?0:1;break;case r.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case r.RepeatWrapping:t.y=t.y-Math.floor(t.y);break;case r.ClampToEdgeWrapping:t.y=t.y<0?0:1;break;case r.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t},e.createClass(i,[{key:"image",get:function(){return this.source.data},set:function(t){this.source.data=t}},{key:"needsUpdate",set:function(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}]),i}(i.EventDispatcher);h.DEFAULT_IMAGE=null,h.DEFAULT_MAPPING=r.UVMapping,t.Texture=h,Object.defineProperty(t,"__esModule",{value:!0})}));
